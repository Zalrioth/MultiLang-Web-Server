<!DOCTYPE html>

<!--
File: index.html
Name: Nicholas Bedner
Assignment Chapter 2
-->

<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
            body {
                background-color: #C1FFFF;
            }
            h1 {
                color: #7F0000;
            }
            h4 {
                color: orange;
                font-style: italic;
            }
        </style>
    </head>
    <body>
        <main>
            <h1>DoWhileTrue Games</h1>
            
            <!-- Attention getter below title -->
            <h4>Cool!</h4>

            <!-- Top navigation bar -->
            <nav>
                <a href="index.html">Home</a> |
                <a href="about.html">About</a> |
                <a href="contact.html">Contact</a> |
            </nav>

            <!-- Small information list -->
            <ul>
                <li>Made with <dfn>JavaScript</dfn>!</li>
                <li><mark>Free</mark> to play in the browser!</li>
                <li>Don't need to download anything!</li>
            </ul>

            <!-- Canvas for drawing -->
            <canvas id="myCanvas" width="400" height="400" style="border:1px solid #000000; background-color: #00E21A">
            </canvas>

            <!-- Script tag for javascript code -->
            <script>
                // Get created canvas
                var canvas = document.getElementById("myCanvas");
                // Get canvas dimensions
                var width = canvas.width;
                var height = canvas.height;
                // Get drawing contect
                var ctx = canvas.getContext("2d");
		var sanic = new Image();
		sanic.src = "sanic.png";
		var sanicX = 40;
		var sanicY = 40;
		var sanicSeekX = Math.random() * width;
		var sanicSeekY = Math.random() * height;
		var sanicSpeed = 3;

		var doge = new Image();
		doge.src = "doge.png";
		var dogeX = width - 140;
		var dogeY = height - 140;
		var dogeSeekX = Math.random() * width;
		var dogeSeekY = Math.random() * height;
		var dogeSpeed = 1.25;

		var mario = new Image();
		mario.src = "mario.png";
		var marioX = width - 140;
		var marioY = 40;
		var marioSeekX = Math.random() * width;
		var marioSeekY = Math.random() * height;
		var marioSpeed = 1.75;

		var shrek = new Image();
		shrek.src = "shrek.png";
		var shrekX = 40;
		var shrekY = height - 140;
		var shrekSeekX = Math.random() * width;
		var shrekSeekY = Math.random() * height;
		var shrekSpeed = 0.5;
                // Function to rotate drawing
		var rotation = 0;
                function rotate() {
                    ctx.clearRect(0, 0, width, height);
                    ctx.translate(width / 2, height / 2);
                    ctx.rotate(rotation);
                    ctx.translate(-width / 2, -height / 2);
		    rotation += Math.PI / 360;
                    ctx.font = "30px Verdana";
                    ctx.textAlign = "center";
                    ctx.textBaseline = "middle";
                    var gradient = ctx.createLinearGradient(0, 0, width, 0);
                    gradient.addColorStop("0.25", "red");
                    gradient.addColorStop("0.5", "yellow");
                    gradient.addColorStop("0.75", "blue");
                    ctx.fillStyle = gradient;
                    ctx.fillText("Cool Game!", width / 2, height / 2);

		    ctx.setTransform(1, 0, 0, 1, 0, 0);

		    ctx.drawImage(sanic,sanicX,sanicY);

		    var sanicDirection = Math.atan2(sanicX - sanicSeekX, sanicY - sanicSeekY);
		    sanicX -= sanicSpeed * Math.sin(sanicDirection);
		    sanicY -= sanicSpeed * Math.cos(sanicDirection);

		    if (Math.sqrt(((sanicSeekX - sanicX) * (sanicSeekX - sanicX)) + ((sanicSeekY - sanicY) * (sanicSeekY - sanicY))) < 5)
		    {
			sanicSeekX = Math.random() * width;
			sanicSeekY = Math.random() * height;
		    }

		    ctx.drawImage(doge,dogeX,dogeY);

		    var dogeDirection = Math.atan2(dogeX - dogeSeekX, dogeY - dogeSeekY);
		    dogeX -= dogeSpeed * Math.sin(dogeDirection);
		    dogeY -= dogeSpeed * Math.cos(dogeDirection);

		    if (Math.sqrt(((dogeSeekX - dogeX) * (dogeSeekX - dogeX)) + ((dogeSeekY - dogeY) * (dogeSeekY - dogeY))) < 5)
		    {
			dogeSeekX = Math.random() * width;
			dogeSeekY = Math.random() * height;
		    }

		    ctx.drawImage(mario,marioX,marioY);

		    var marioDirection = Math.atan2(marioX - marioSeekX, marioY - marioSeekY);
		    marioX -= marioSpeed * Math.sin(marioDirection);
		    marioY -= marioSpeed * Math.cos(marioDirection);

		    if (Math.sqrt(((marioSeekX - marioX) * (marioSeekX - marioX)) + ((marioSeekY - marioY) * (marioSeekY - marioY))) < 5)
		    {
			marioSeekX = Math.random() * width;
			marioSeekY = Math.random() * height;
		    }

		    ctx.drawImage(shrek,shrekX,shrekY);

		    var shrekDirection = Math.atan2(shrekX - shrekSeekX, shrekY - shrekSeekY);
		    shrekX -= shrekSpeed * Math.sin(shrekDirection);
		    shrekY -= shrekSpeed * Math.cos(shrekDirection);

		    if (Math.sqrt(((shrekSeekX - shrekX) * (shrekSeekX - shrekX)) + ((shrekSeekY - shrekY) * (shrekSeekY - shrekY))) < 5)
		    {
			shrekSeekX = Math.random() * width;
			shrekSeekY = Math.random() * height;
		    }
                }
                // Automatically call function
                setInterval(rotate, 30);
            </script>
        </main>
		<script>
			var socket = new WebSocket("ws://52.25.156.220:8810");
			socket.onmessage = function (event) {
				var received = document.getElementById("received");
				var br = document.createElement("BR");
				var text = document.createTextNode(event.data);
				received.appendChild(br);
				received.appendChild(text);
			};
			
			function send(element) {
				var input = document.getElementById(element);
				socket.send(input.value);
				input.value = "";
			}
		</script>
			<p id="received">
				<strong>Received Messages:</strong>
			</p>
			<form onsubmit="send('message'); return false">
				<input type="text" id="message">
				<input type="submit" value="Send">
			</form>
        <!-- Footer with copyright and email -->
        <footer>
            <p>Copyright &copy <i>2017 Nicholas Bedner</i></p>
            <p><a href="mailto:nicholasbedner@gmail.com">NicholasBedner@gmail.com</a>.</p>
        </footer>
    </body>
</html>
